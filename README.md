
Platform
========================================================
* Host OS: Windows 7/8, 4GB Memory, Core i5 or i7, with CUDA support is a plus.
* Target OS: Android 4.2/4.4, Android 5
* Target Platform: CLT PR phone, Nexus 5, Nexus 7, Memo pad and Fugu

Pre-requirements
========================================================
* Java JDK 1.5 or greater http://www.oracle.com/technetwork/java/javase/downloads/index.html
* Android SDK http://developer.android.com
* Python 2.7 https://www.python.org/download/

Installation
========================================================
1. Download DaVinci package 2.2.6 or higher from \\ccr\ec\proj\ssg\dpd\BiTS\DaVinci_Customers\Releases\2.2.6\DaVinci_Install.zip
2. Unzip DaVinci_Install.zip, run Single_Click_Installation.bat
3. Download Crosswalk Top App Test Suite from https://github.com/crosswalk-project/crosswalk-test-suite/tree/master/misc/topapp-android-tests

Preconditions
========================================================

Android Settings:
===================
    1.    Developer options:
                Enable usb debugging
                Stay awake
                Do not lock screen
    2.    Security:
                Allowing app installs from "Unknown sources"
    3.    Display:
                Sleep: Max value (30 minutes or never)
                Brightness: Low
    4.    Power Saver:
                Disable Blue tooth, GPS
    5.    WIFI:
                Enable and keep connected
    6.    Charging:
                Keep charging.
    7.    Set System language to English

config.json:
===================
Update key fields of config.json in /webapp-monkey-android-tests/script/ folder:

{
  "davinci": {
    "davinci_path": "C:/Intel/BiTS/DaVinci/",
    "davinci_device_environment_set": "true",
    "davinci_timeout": "300",
    "davinci_rerun_max": "1",
    "davinci_action_number": "10",
    "davinci_click_percentage": "82",
    "davinci_swipe_percentage": "18",
    "davinci_battery_threshold": "10"
  },
  "runtimelib": {
    "runtimelib_package": "org.xwalk.core",
    "runtimelib_apk": "XWalkRuntimeLib.apk"
  },
  "runtimelib_test_build": [
    {"rtlib_test_build": "11.39.265.0"},
    {"rtlib_test_build": "11.39.251.0"}
  ],
  "test_result": {
    "test_result_dir": "C:/Users/zhangmin/Desktop/CCC",
    "test_result_xml_name": "webapp-monkey-android-tests-result.xml"
  },
  "logcat_check": [
    {"keyword_fail": "WIN DEATH"},
    {"keyword_fail": "has died"},
    {"keyword_fail": "Fatal"},
    {"keyword_fail": "ANR"},
    {"keyword_fail": "not responding"},
    {"keyword_fail": "uncaused exception"}
  ],
  "device": [
    {"device_id":"E6OKCY410605", "device_name":"ASUS Memo Pad K001", "device_arch": "x86"}
  ]
}

* List 2 or more runtimelib_test_build will run the monkey tests on 2 or more RuntimeLib builds orderly.
* Default davinci_timeout value is 600.
* Default davinci_rerun_max value is 3.
* Default davinci_action_number value is 10. Modify the value will cause the whole testing time changes.
* Make sure: davinci_click_percentage value + davinci_swipe_percentage value == 100
* Battery threshold value means the minimal battery 10% can be accepted to run the tests, or the tests will be suspended until charged more than 10%.
* The keywords of Logcat results check including Crash, Fatal Error, Android Not Response etc., you can add more conditions. The keywords are case insensitive.

How to Run
========================================================
1. Put corresponding RuntimeLib.apk in /runtimelib/<build>/<arch> folders
2. cd webapp-monkey-android-tests
3. python run.py
   //Make sure the version (test build) of RuntimeLib.apk, "device_id" and "device_arch" are all set in config.json

   python run.py -v 11.39.251.0
   //11.39.251.0 means the version of RuntimeLib.apk

   python run.py -v 11.39.251.0 -a x86 -d MedfieldC3567E1E
   //You can also type commands below instead if you don't want to set "device_id" and "device_arch" in config.json.

Test Results:
========================================================
* The test results will be located in:
    "test_result": {
        "test_result_dir": "C:/SampleAppTest/result",
    }
* [DeviceID]/[DateTime]/[test.result.xml] is the XML file for uploading to WRT QA report.
* [TestResult_DateTime]/Smoke_Test_Report.csv is the csv file (not WRT QA report compatible) generated by DaVinci which is for manual re-checking.
* [_DaVinci_RnR_Logs] is generated by Davinci including detailed test logs and results.

Issues
========================================================
* If you encounter 'wmic' relevant error, add environment variables %SystemRoot%\System32\Wbem; in PATH.


